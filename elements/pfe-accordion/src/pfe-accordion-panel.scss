@import "shared-assets";

/// ===========================================================================
/// DEFAULT ACCORDION PANEL
/// ===========================================================================

:host {
  @include pfe-collapsible($state: closed);  
  @include pfe-box-sizing;
   
  margin: 0;
  width: pfe-local(Width, 100%);
  max-width: calc(100% - #{pfe-var(surface--border-width--heavy)});
  height: auto;
  position: relative;

  // Since the default bg color is transparent, look to broadcast values
  background-color: pfe-local(BackgroundColor, transparent);
  color:            pfe-local(Color);

  // Border settings
  border: 0 pfe-var(surface--border-style) pfe-local(BorderColor);
  border-top-width:     pfe-local(BorderTopWidth);
  border-right-width:   pfe-local(BorderRightWidth);
  border-bottom-width:  pfe-local(BorderBottomWidth);
  border-left: pfe-local(BorderLeftWidth) pfe-var(surface--border-style) pfe-local(BorderColor--accent);

  box-shadow: pfe-local(BoxShadow);
  z-index:    pfe-local(ZIndex);

  &:hover {
    --pfe-accordion--BorderColor--accent: #{pfe-local(accent)};
  }
}

:host(.animating) {
  display: block;
  transition: height 0.3s ease-in-out;
}

.container {
  // Ensure the box shadow does not propagate to nest accordions
  --pfe-accordion--BoxShadow: none;

  @extend %container;
  @include pfe-clearfix;

  padding: pfe-local(Padding, $region: panel-container, $fallback: 0 calc(#{pfe-var(container-spacer)} * 3) pfe-var(container-spacer) calc(#{pfe-var(container-spacer)} * 1.5));

  :host([pfe-disclosure="true"]) & {
    padding: pfe-local(Padding, $region: panel-container, $fallback: 0 calc(#{pfe-var(container-spacer)} * 3) pfe-var(container-spacer) calc(#{pfe-var(container-spacer)} * 1.5 - 4px));
  }
}

:host(:last-of-type[expanded]) {
  margin-bottom: 0;
}

/// ===========================================================================
/// EXPANDED STYLES
/// ===========================================================================

:host([expanded]),
:host(.animating) {
  // TODO
  --pfe-accordion--BorderColor--accent: pfe-local(accent);

  @include pfe-collapsible($state: open);

  border-color: pfe-local(BorderColor, pfe-var(surface--border));

  border-top-width:   pfe-local(BorderTopWidth, 0);
  border-right-width: pfe-local(BorderRightWidth, pfe-var(surface--border-width));
  border-left-width:  pfe-local(BorderLeftWidth, pfe-var(surface--border-width--heavy));

  // Defaults for light theme
  background-color: pfe-local(BackgroundColor, rgba(255, 255, 255, 1));
  color: pfe-local(Color, pfe-var(text));
  
  box-shadow: pfe-local(BoxShadow, 0 5px pfe-var(surface--border-width--heavy) rgba(140, 140, 140, 0.35));
  z-index:    pfe-local(ZIndex, 3);

  @include browser-query(ie11) {
    border-top-width: 0;
    border-left-color: pfe-var(ui-accent);
    border-right-color: pfe-var(surface--border);
  }
}

:host([on="dark"][expanded]),
:host([on="dark"].animating){
  // TODO
  --pfe-accordion--BorderColor--accent: pfe-local(accent--on-dark);

  background-color: pfe-local(BackgroundColor, rgba(247, 247, 249, .1));
  color: pfe-local(Color, pfe-broadcasted(text));

  box-shadow: pfe-local(BoxShadow, none);
}

:host([on="saturated"][expanded]),
:host([on="saturated"].animating){
  // TODO
  --pfe-accordion--BorderColor--accent: pfe-local(accent--on-saturated);

  background-color: pfe-local(BackgroundColor, rgba(0, 0, 0, 0.2));
  color: pfe-local(Color, pfe-broadcasted(text));

  box-shadow: pfe-local(BoxShadow, none);
}

:host([pfe-disclosure="true"]) {
  --pfe-accordion--BorderColor--accent: #{pfe-var(surface--border)};
  
  border-right-width: pfe-local(BorderRightWidth, pfe-var(surface--border-width));
  border-left-width:  pfe-local(BorderLeftWidth, pfe-var(surface--border-width));
}
