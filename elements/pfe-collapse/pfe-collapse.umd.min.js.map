{"version":3,"file":"pfe-collapse.umd.min.js","sources":["pfe-collapse.js"],"sourcesContent":["import PFElement from '../pfelement/pfelement.js';\n\n/*!\n * PatternFly Elements: PfeCollapse 1.0.0-prerelease.21\n * @license\n * Copyright 2019 Red Hat, Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * \n*/\n\nfunction generateId() {\n  return Math.random()\n    .toString(36)\n    .substr(2, 9);\n}\n\nclass PfeCollapseToggle extends PFElement {\n  static get version() {\n    return \"1.0.0-prerelease.21\";\n  }\n\n  get html() {\n    return `<style>:host{display:block;cursor:default}</style><slot></slot>`;\n  }\n\n  static get properties() {\n    return {};\n  }\n\n  static get slots() {\n    return {\"default\":{\"title\":\"Default\",\"type\":\"array\",\"namedSlot\":false,\"items\":{\"oneOf\":[{\"$ref\":\"pfe-collapsibe-toggle\"},{\"$ref\":\"pfe-collapse-panel\"}]}}};\n  }\n  static get tag() {\n    return \"pfe-collapse-toggle\";\n  }\n\n  get templateUrl() {\n    return \"pfe-collapse-toggle.html\";\n  }\n\n  get styleUrl() {\n    return \"pfe-collapse-toggle.scss\";\n  }\n\n  get pfeId() {\n    return this.getAttribute(\"pfe-id\");\n  }\n\n  set pfeId(id) {\n    if (!id) {\n      return;\n    }\n\n    this.setAttribute(\"pfe-id\", id);\n  }\n\n  get expanded() {\n    return this.getAttribute(\"aria-expanded\") === \"true\";\n  }\n\n  set expanded(val) {\n    const value = Boolean(val);\n    this.setAttribute(\"aria-expanded\", value);\n  }\n\n  static get observedAttributes() {\n    return [\"aria-controls\"];\n  }\n\n  constructor(pfeClass, { setTabIndex = true, addKeydownHandler = true } = {}) {\n    super(pfeClass || PfeCollapseToggle);\n\n    this.controlledPanel = false;\n    this._setTabIndex = setTabIndex;\n    this._addKeydownHandler = addKeydownHandler;\n\n    this.addEventListener(\"click\", this._clickHandler);\n\n    if (addKeydownHandler) {\n      this.addEventListener(\"keydown\", this._keydownHandler);\n    }\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.expanded = false;\n\n    // if (this.id && this.id !== \"\") {\n    if (this.id) {\n      this.pfeId = this.id;\n    }\n\n    const generatedId = `${PfeCollapseToggle.tag}-${generateId()}`;\n\n    if (!this.id) {\n      this.id = generatedId;\n    }\n\n    if (!this.pfeId) {\n      this.pfeId = generatedId;\n    }\n\n    this.setAttribute(\"role\", \"button\");\n\n    if (this._setTabIndex) {\n      this.setAttribute(\"tabindex\", 0);\n    }\n  }\n\n  disconnectedCallback() {\n    this.removeEventListener(\"click\", this._clickHandler);\n\n    if (this._addKeydownHandler) {\n      this.removeEventListener(\"keydown\", this._keydownHandler);\n    }\n  }\n\n  attributeChangedCallback(attr, oldVal, newVal) {\n    super.attributeChangedCallback(attr, oldVal, newVal);\n\n    if (!newVal) {\n      return;\n    }\n\n    // this can be an issue if the pfe-collapse is located within\n    // a shadow root\n    if (this.getRootNode) {\n      this.controlledPanel = this.getRootNode().querySelector(`#${newVal}`);\n    } else {\n      this.controlledPanel = document.querySelector(`#${newVal}`);\n    }\n  }\n\n  toggle() {\n    this.expanded = !this.expanded;\n\n    if (this.controlledPanel) {\n      this.controlledPanel.expanded = this.expanded;\n\n      this.dispatchEvent(\n        new CustomEvent(`${PfeCollapse.tag}:change`, {\n          detail: {\n            expanded: this.expanded,\n            toggle: this,\n            panel: this.controlledPanel\n          },\n          bubbles: true\n        })\n      );\n    } else {\n      console.warn(\n        `${this.tag}: This toggle doesn't have a panel associated with it`\n      );\n    }\n  }\n\n  _clickHandler() {\n    this.toggle();\n  }\n\n  _keydownHandler(event) {\n    const key = event.key;\n\n    switch (key) {\n      case \" \":\n      case \"Spacebar\":\n      case \"Enter\":\n        this.toggle();\n        break;\n    }\n  }\n}\n\nclass PfeCollapsePanel extends PFElement {\n  static get version() {\n    return \"1.0.0-prerelease.21\";\n  }\n\n  get html() {\n    return `<style>:host{display:none;overflow:hidden;will-change:height}:host([pfe-expanded]){display:block;position:relative}:host(.animating){display:block;-webkit-transition:height .3s ease-in-out;transition:height .3s ease-in-out}</style><slot></slot>`;\n  }\n\n  static get properties() {\n    return {};\n  }\n\n  static get slots() {\n    return {\"default\":{\"title\":\"Default\",\"type\":\"array\",\"namedSlot\":false,\"items\":{\"oneOf\":[{\"$ref\":\"pfe-collapsibe-toggle\"},{\"$ref\":\"pfe-collapse-panel\"}]}}};\n  }\n  static get tag() {\n    return \"pfe-collapse-panel\";\n  }\n\n  get templateUrl() {\n    return \"pfe-collapse-panel.html\";\n  }\n\n  get styleUrl() {\n    return \"pfe-collapse-panel.scss\";\n  }\n\n  get pfeId() {\n    return this.getAttribute(\"pfe-id\");\n  }\n\n  set pfeId(id) {\n    if (!id) {\n      return;\n    }\n\n    this.setAttribute(\"pfe-id\", id);\n  }\n\n  get animates() {\n    return this.getAttribute(\"pfe-animation\") === \"false\" ? false : true;\n  }\n\n  get expanded() {\n    return this.hasAttribute(\"pfe-expanded\");\n  }\n\n  set expanded(val) {\n    const value = Boolean(val);\n\n    if (value) {\n      this.setAttribute(\"pfe-expanded\", \"\");\n\n      if (this.animates) {\n        const height = this.getBoundingClientRect().height;\n        this._fireAnimationEvent(\"opening\");\n        this._animate(0, height);\n      }\n    } else {\n      if (this.hasAttribute(\"pfe-expanded\")) {\n        const height = this.getBoundingClientRect().height;\n        this.removeAttribute(\"pfe-expanded\");\n\n        if (this.animates) {\n          this._fireAnimationEvent(\"closing\");\n          this._animate(height, 0);\n        }\n      }\n    }\n  }\n\n  constructor(pfeClass) {\n    super(pfeClass || PfeCollapsePanel);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.expanded = false;\n\n    // if (this.id && this.id !== \"\") {\n    if (this.id) {\n      this.pfeId = this.id;\n    }\n\n    const generatedId = `${PfeCollapsePanel.tag}-${generateId()}`;\n\n    if (!this.id) {\n      this.id = generatedId;\n    }\n\n    if (!this.pfeId) {\n      this.pfeId = generatedId;\n    }\n  }\n\n  _animate(start, end) {\n    this.classList.add(\"animating\");\n    this.style.height = `${start}px`;\n\n    requestAnimationFrame(() => {\n      requestAnimationFrame(() => {\n        this.style.height = `${end}px`;\n        this.classList.add(\"animating\");\n        this.addEventListener(\"transitionend\", this._transitionEndHandler);\n      });\n    });\n  }\n\n  _transitionEndHandler(event) {\n    event.target.style.height = \"\";\n    event.target.classList.remove(\"animating\");\n    event.target.removeEventListener(\n      \"transitionend\",\n      this._transitionEndHandler\n    );\n\n    this.dispatchEvent(\n      new CustomEvent(`${PfeCollapsePanel.tag}:animation-end`, {\n        detail: {\n          expanded: this.expanded,\n          panel: this\n        },\n        bubbles: true\n      })\n    );\n  }\n\n  _fireAnimationEvent(state) {\n    this.dispatchEvent(\n      new CustomEvent(`${PfeCollapsePanel.tag}:animation-start`, {\n        detail: {\n          state: state,\n          panel: this\n        },\n        bubbles: true\n      })\n    );\n  }\n}\n\nclass PfeCollapse extends PFElement {\n  static get version() {\n    return \"1.0.0-prerelease.21\";\n  }\n\n  get html() {\n    return `<style>:host{display:block}:host([hidden]){display:none}:host(.animating),:host([expanded]){display:block}</style><slot></slot>`;\n  }\n\n  static get properties() {\n    return {};\n  }\n\n  static get slots() {\n    return {\"default\":{\"title\":\"Default\",\"type\":\"array\",\"namedSlot\":false,\"items\":{\"oneOf\":[{\"$ref\":\"pfe-collapsibe-toggle\"},{\"$ref\":\"pfe-collapse-panel\"}]}}};\n  }\n  static get tag() {\n    return \"pfe-collapse\";\n  }\n\n  get templateUrl() {\n    return \"pfe-collapse.html\";\n  }\n\n  get styleUrl() {\n    return \"pfe-collapse.scss\";\n  }\n\n  get schemaUrl() {\n    return \"pfe-collapse.json\";\n  }\n\n  get animates() {\n    return this.getAttribute(\"pfe-animation\") === \"false\" ? false : true;\n  }\n\n  static get observedAttributes() {\n    return [\"pfe-animation\"];\n  }\n\n  constructor(pfeClass) {\n    super(pfeClass || PfeCollapse);\n\n    this._toggle = null;\n    this._panel = null;\n    this._linkControls = this._linkControls.bind(this);\n    this._changeHandler = this._changeHandler.bind(this);\n    this._observer = new MutationObserver(this._linkControls);\n\n    this.addEventListener(`${PfeCollapse.tag}:change`, this._changeHandler);\n    this.addEventListener(`${PfeCollapsePanel.tag}:animation-start`, this._animationStartHandler);\n    this.addEventListener(`${PfeCollapsePanel.tag}:animation-end`, this._animationEndHandler);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    Promise.all([\n      customElements.whenDefined(PfeCollapsePanel.tag),\n      customElements.whenDefined(PfeCollapseToggle.tag)\n    ]).then(() => {\n      if (this.children.length) {\n        this._linkControls();\n      }\n\n      this._observer.observe(this, { childList: true });\n    });\n  }\n\n  disconnectedCallback() {\n    this.removeEventListener(`${PfeCollapse.tag}:change`, this._changeHandler);\n    this.removeEventListener(`${PfeCollapsePanel.tag}:animation-start`, this._animationStartHandler);\n    this.removeEventListener(`${PfeCollapsePanel.tag}:animation-end`, this._animationEndHandler);\n    this._observer.disconnect();\n  }\n\n  attributeChangedCallback(attr, oldVal, newVal) {\n    super.attributeChangedCallback(attr, oldVal, newVal);\n\n    if (!newVal) {\n      return;\n    }\n\n    if (newVal !== \"false\" && newVal !== \"true\") {\n      return;\n    }\n\n    if (this._panel) {\n      this._panel.setAttribute(\"pfe-animation\", newVal);\n    }\n  }\n\n  toggle() {\n    this._toggle.toggle();\n  }\n\n  _linkControls() {\n    this._toggle = this.querySelector(PfeCollapseToggle.tag);\n    this._panel = this.querySelector(PfeCollapsePanel.tag);\n\n    this._toggle.setAttribute(\"aria-controls\", this._panel.pfeId);\n  }\n\n  _animationStartHandler() {\n    this.classList.add(\"animating\");\n  }\n\n  _animationEndHandler() {\n    this.classList.remove(\"animating\");\n  }\n\n  _changeHandler(event) {\n\n  }\n}\n\nPFElement.create(PfeCollapse);\nPFElement.create(PfeCollapseToggle);\nPFElement.create(PfeCollapsePanel);\n\nexport { PfeCollapse, PfeCollapseToggle, PfeCollapsePanel };\n//# sourceMappingURL=pfe-collapse.js.map\n"],"names":["generateId","Math","random","toString","substr","PfeCollapseToggle","PFElement","this","getAttribute","id","setAttribute","val","value","Boolean","default","title","type","namedSlot","items","oneOf","$ref","expanded","pfeId","generatedId","tag","_setTabIndex","removeEventListener","_clickHandler","_addKeydownHandler","_keydownHandler","attr","oldVal","newVal","getRootNode","controlledPanel","querySelector","document","dispatchEvent","CustomEvent","PfeCollapse","warn","toggle","event","key","pfeClass","setTabIndex","addKeydownHandler","addEventListener","_this","PfeCollapsePanel","hasAttribute","animates","height","getBoundingClientRect","_fireAnimationEvent","_animate","removeAttribute","start","end","classList","add","style","_this3","_transitionEndHandler","target","remove","state","all","customElements","whenDefined","then","_this5","children","length","_linkControls","_observer","observe","childList","_changeHandler","_animationStartHandler","_animationEndHandler","disconnect","_panel","_toggle","_this4","bind","MutationObserver","create"],"mappings":"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"}