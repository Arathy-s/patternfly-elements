{"version":3,"file":"pfe-pagination.min.js","sources":["pfe-pagination.js"],"sourcesContent":["import PFElement from '../pfelement/pfelement.js';\n\n/*\n * Copyright 2019 Red Hat, Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * \n*/\n\nclass PfePagination extends PFElement {\n  get html() {\n    return `<style>:host {\n  display: block; }\n\n:host([hidden]) {\n  display: none; }\n\n:focus:not(:focus-visible) {\n  outline: none; }\n\nnav *, nav *::before, nav *::after {\n  box-sizing: border-box; }\n\nnav ul {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n  display: flex;\n  align-items: baseline; }\n  nav ul li {\n    margin: 1px;\n    display: flex; }\n    nav ul li .ellipses {\n      display: block;\n      padding: 0 calc(var(--pfe-theme--font-size, 16px) * 0.75);\n      line-height: calc( var(--pfe-theme--font-size, 16px) * 2.5);\n      min-height: calc( var(--pfe-theme--font-size, 16px) * 2.5);\n      min-width: calc( var(--pfe-theme--font-size, 16px) * 2.5); }\n    nav ul li > a {\n      display: block;\n      padding: 0 calc(var(--pfe-theme--font-size, 16px) * 0.75);\n      line-height: calc( var(--pfe-theme--font-size, 16px) * 2.5);\n      min-height: calc( var(--pfe-theme--font-size, 16px) * 2.5);\n      min-width: calc( var(--pfe-theme--font-size, 16px) * 2.5);\n      border: var(--pfe-theme--ui--border-width, 1px) var(--pfe-theme--ui--border-style, solid) transparent;\n      background: var(--pfe-theme--color--ui-subtle, #f3f3f3);\n      color: var(--pfe-theme--color--ui-subtle--text, #333);\n      text-align: center;\n      text-decoration: none;\n      vertical-align: middle; }\n      nav ul li > a:hover, nav ul li > a:focus, nav ul li > a:active {\n        background: var(--pfe-theme--color--ui-base, #0477a4);\n        color: var(--pfe-theme--color--ui-base--text, #fff); }\n      nav ul li > a[aria-current] {\n        background: var(--pfe-theme--color--ui-complement, #464646);\n        color: var(--pfe-theme--color--ui-complement--text, #fff); }\n    nav ul li#next {\n      order: 10; }\n\n#jump {\n  margin: 0 var(--pfe-theme--container-spacer, 1rem); }\n  #jump a {\n    color: var(--pfe-theme--color--ui-link, #06c);\n    text-decoration: none; }\n    #jump a:hover {\n      color: var(--pfe-theme--color--ui-link--hover, #003366);\n      text-decoration: underline; }\n    #jump a:focus {\n      color: var(--pfe-theme--color--ui-link--focus, #003366);\n      text-decoration: underline; }\n\n#currentPageInput {\n  margin-right: calc(var(--pfe-theme--content-spacer, 1rem) * 0.5);\n  padding: 0 calc(var(--pfe-theme--font-size, 16px) * 0.75);\n  line-height: calc(var(--pfe-theme--font-size, 16px) * 2.5);\n  min-height: calc(var(--pfe-theme--font-size, 16px) * 2.5);\n  border: var(--pfe-theme--ui--border-width, 1px) var(--pfe-theme--ui--border-style, solid) var(--pfe-theme--color--surface--border, #dfdfdf);\n  box-shadow: var(--pfe-theme--box-shadow--input, );\n  width: 4em;\n  font-size: inherit; }</style>\n<nav role=\"navigation\" aria-label=\"Pagination\">\n  <ul>\n    ${this.showJump ? `\n      ${!this.showPages ? `\n        <li><a href=\"#\" id=\"previous\">${this.previousText}</a></li>\n        <li><a href=\"#\" id=\"next\">${this.nextText}</a></li>\n      ` : ``}\n      <li id=\"jump\">\n        <form>\n          <input\n            type=\"number\"\n            id=\"currentPageInput\"\n            value=\"${this.currentPage}\"\n            min=\"1\"\n            max=\"${this.totalPages}\"> of\n          <a href=\"#\" id=\"lastPage\" page=\"${this.totalPages}\">${this.totalPages}</a>\n        </form>\n      </li>\n    ` : ``}\n    ${this.showPages ? `\n      <li><a href=\"#\" id=\"previous\">${this.previousText}</a></li>\n      ${this.pages.map(page => `\n        <li>\n          ${page.ellipsize ? `\n            <div class=\"ellipses\">${page.text}</div>\n          ` : `\n            <a\n              href=\"#\"\n              class=\"page\"\n              page=\"${page.text}\"\n              aria-label=\"${page.ariaLabel}\"\n              ${this.currentPage == page.text ? ` aria-current=\"true\"` : `` }>\n              ${page.text}\n            </a>\n          `}\n        </li>\n      `).join(\"\\n\")}\n      <li><a href=\"#\" id=\"next\">${this.nextText}</a></li>\n    `: ``}\n  </ul>\n</nav>`;\n  }\n\n  static get tag() {\n    return \"pfe-pagination\";\n  }\n\n  get templateUrl() {\n    return \"pfe-pagination.html\";\n  }\n\n  get styleUrl() {\n    return \"pfe-pagination.scss\";\n  }\n\n  get showPages() {\n    return this.hasAttribute(\"show-pages\");\n  }\n\n  get showJump() {\n    return this.hasAttribute(\"show-jump\");\n  }\n\n  get totalPages() {\n    return Number(this.getAttribute(\"total-pages\"));\n  }\n\n  get currentPage() {\n    return Number(this.getAttribute(\"current-page\"));\n  }\n\n  set currentPage(val) {\n    let page = Number(val);\n\n    if (page < 1) {\n      page = 1;\n    }\n\n    if (page > this.totalPages) {\n      page = this.totalPages;\n    }\n\n    this.setAttribute(\"current-page\", page);\n\n    this.dispatchEvent(\n      new CustomEvent(`${PfePagination.tag}:page-change`, {\n        detail: {\n          page: page\n        },\n        bubbles: true\n      })\n    );\n  }\n\n  static get observedAttributes() {\n    return [\"total-pages\", \"show-jump\", \"show-pages\", \"current-page\"];\n  }\n\n  constructor() {\n    super(PfePagination, {\n      delayRender: true\n    });\n\n    this.previousText = \"Previous\";\n    this.nextText = \"Next\";\n    this.pages = [];\n\n    this._clickHandler = this._clickHandler.bind(this);\n    this._submitHandler = this._submitHandler.bind(this);\n    this.previousPage = this.previousPage.bind(this);\n    this.nextPage = this.nextPage.bind(this);\n    this._childrenAvailable = this._childrenAvailable.bind(this);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._isReady();\n\n    this._observer = new MutationObserver(this._childrenAvailable);\n\n    this._observer.observe(this, {\n      childList: true\n    });\n  }\n\n  disconnectedCallback() {\n    this._observer.disconnect();\n  }\n\n  _isReady() {\n    if (this.firstChild) {\n      if (this._observer) {\n        this._observer.disconnect();\n      }\n      \n      this._childrenAvailable();\n    }\n  }\n\n  _childrenAvailable() {\n    const previousControl = this.querySelector('[control=\"previous\"]');\n    const nextControl = this.querySelector('[control=\"next\"]');\n\n    this.previousText = previousControl.textContent || \"Previous\";\n    this.nextText = nextControl.textContent || \"Next\";\n\n    this._setup();\n    this._rendered = true;\n  }\n\n  attributeChangedCallback(attr, oldValue, newValue) {\n    if (!this._rendered) {\n      return;\n    }\n\n    this._setup();\n  }\n\n  previousPage(event) {\n    if (event) {\n      event.preventDefault();\n    }\n\n    this.currentPage -= 1;\n  }\n\n  nextPage(event) {\n    if (event) {\n      event.preventDefault();\n    }\n\n    this.currentPage += 1;\n  }\n\n  _setup() {\n    this.maxPagesShown = this.showJump && this.showPages ? 7 : 9;\n\n    if (this.maxPagesShown > this.totalPages) {\n      this.maxPagesShown = this.totalPages;\n    }\n\n    if (this.showPages) {\n      const truncatePageNumbers = this.totalPages > this.maxPagesShown;\n      const loopPages = truncatePageNumbers\n        ? this.maxPagesShown\n        : this.totalPages;\n      const mean = Math.ceil(this.maxPagesShown / 2);\n      const minMaxDistance = mean - 1;\n      const ellipsizeStart = this.currentPage - minMaxDistance > 1;\n      const ellipsizeEnd = this.currentPage + minMaxDistance < this.totalPages;\n\n      this.pages = [];\n\n      this.pages[0] = {\n        ellipsize: false,\n        ariaLabel: this._getAriaLabel(1),\n        text: 1\n      };\n\n      for (var i = 1; i <= loopPages - 2; i++) {\n        if (\n          ((i === 1 && ellipsizeStart) ||\n            (i === this.maxPagesShown - 2 && ellipsizeEnd)) &&\n          truncatePageNumbers\n        ) {\n          this.pages[i] = {\n            ellipsize: true,\n            text: \"...\"\n          };\n        } else {\n          let pageNumber = this.currentPage - minMaxDistance + i;\n\n          if (!ellipsizeStart) {\n            pageNumber = i + 1;\n          }\n\n          if (!ellipsizeEnd) {\n            pageNumber = this.totalPages - (this.maxPagesShown - 1) + i;\n          }\n\n          this.pages[i] = {\n            ellipsize: false,\n            ariaLabel: this._getAriaLabel(pageNumber),\n            text: pageNumber\n          };\n        }\n      }\n\n      this.pages[loopPages - 1] = {\n        ellipsize: false,\n        ariaLabel: this._getAriaLabel(this.totalPages),\n        text: this.totalPages\n      };\n    }\n\n    this.render();\n\n    this.shadowRoot\n      .querySelector(\"#previous\")\n      .addEventListener(\"click\", this.previousPage);\n    this.shadowRoot\n      .querySelector(\"#next\")\n      .addEventListener(\"click\", this.nextPage);\n\n    if (this.showPages) {\n      const pages = [...this.shadowRoot.querySelectorAll(\"a.page\")];\n      pages.forEach(page => {\n        page.addEventListener(\"click\", this._clickHandler);\n      });\n    }\n\n    if (this.showJump) {\n      const form = this.shadowRoot.querySelector(\"form\");\n      form.addEventListener(\"submit\", this._submitHandler);\n\n      const lastPage = this.shadowRoot.querySelector(\"#lastPage\");\n      lastPage.addEventListener(\"click\", this._clickHandler);\n    }\n  }\n\n  _clickHandler(event) {\n    event.preventDefault();\n    this.currentPage = event.currentTarget.getAttribute(\"page\");\n  }\n\n  _submitHandler(event) {\n    event.preventDefault();\n\n    const currentPageInput = this.shadowRoot.querySelector(\"#currentPageInput\");\n    this.currentPage = currentPageInput.value;\n  }\n\n  _getAriaLabel(page) {\n    return page === this.currentPage\n      ? `Page ${page}, Current Page`\n      : `Page ${page}`;\n  }\n}\n\nPFElement.create(PfePagination);\n\nexport default PfePagination;\n//# sourceMappingURL=pfe-pagination.js.map\n"],"names":["PfePagination","PFElement","html","this","showJump","showPages","previousText","nextText","currentPage","totalPages","pages","map","page","ellipsize","text","ariaLabel","join","tag","templateUrl","styleUrl","hasAttribute","Number","getAttribute","val","setAttribute","dispatchEvent","CustomEvent","detail","bubbles","observedAttributes","[object Object]","super","delayRender","_clickHandler","bind","_submitHandler","previousPage","nextPage","_childrenAvailable","connectedCallback","_isReady","_observer","MutationObserver","observe","childList","disconnect","firstChild","previousControl","querySelector","nextControl","textContent","_setup","_rendered","attr","oldValue","newValue","event","preventDefault","maxPagesShown","truncatePageNumbers","loopPages","minMaxDistance","Math","ceil","ellipsizeStart","ellipsizeEnd","_getAriaLabel","i","pageNumber","render","shadowRoot","addEventListener","querySelectorAll","forEach","currentTarget","currentPageInput","value","create"],"mappings":"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"}